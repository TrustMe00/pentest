# ###########################################################
# author : 
# name : generator.py
# version : 1.1
# Python version : 3
# description : generateur de wordlist basé sur des mots
# ###########################################################
# modules
import os
import math
from itertools import islice
# fonctions utiles
def convert_size(size_bytes):
    if size_bytes == 0:
        return "0B"
    size_name = ("B", "KB", "MB", "GB", "TB", "PB", "EB", "ZB", "YB")
    i = int(math.floor(math.log(size_bytes, 1024)))
    p = math.pow(1024, i)
    s = round(size_bytes / p, 2)
    return "%s %s" % (s, size_name[i])
def leet(text):
    getchar = lambda c: chars[c] if c in chars else c
    chars = {"a":"4","e":"3","l":"1","o":"0","s":"5"}
    return ''.join(getchar(c) for c in text)

with open("data.txt", "r") as f:   
    for line in f.readlines():
        mot = line.strip()
        f = open("dico.txt", "a")
        print(mot)
        # password
        f.write(mot + '\n')
        print(mot.title())
        # Password
        f.write(mot.title() + '\n')
        i = 0
        while i <= 99999:
            print(mot + str(i))
            # password00000 à password99999
            f.write(mot + str(i) + '\n')
            print(mot.title() + str(i))
            # Password00000 à Password99999
            f.write(mot.title() + str(i) + '\n')
            print(leet(mot + str(i)))
            # p4550rd00000 à p4550rd99999
            f.write(leet(mot + str(i)) + '\n')
            print(leet(mot.title() + str(i)))
            # P4550rd99999 à P4550rd99999
            f.write(leet(mot.title() + str(i)) + '\n')
            i = i + 1   
        print(leet(mot))
        # p4550rd
        f.write(leet(mot) + '\n')
        # https://www.owasp.org/index.php/Password_special_characters
        SpecialChars = ["@", "!", "#", "&", ")","(","+","-", "=", "?","/", "[", "]","{","}","_"]
        for value in SpecialChars:
            # password@
            print(mot + value)
            f.write(mot + value + '\n')
            # Password@
            print(mot.title() + value)
            f.write(mot.title() + value + '\n')
        i = 0
        while i <= 99999:
            for value in SpecialChars:
                # password00000@
                print(mot + str(i) + value)                
                f.write(mot + str(i) + value + '\n')                
                # Password00000@         
                print(mot.title() + str(i) + value)
                f.write(mot.title() + str(i) + value + '\n')
                # p4550rd00000@
                print(leet(mot) + str(i) + value)
                f.write(leet(mot) + str(i) + value + '\n')
                # P4550rd00000@
                print(leet(mot.title()) + str(i) + value)
                f.write(leet(mot.title()) + str(i) + value + '\n')                             
                # password@00000
                print(mot + value + str(i))
                f.write(mot + value + str(i) + '\n')
                # Password@00000
                print(mot.title() + value + str(i))
                f.write(mot.title() + value + str(i) + '\n')
                # @password00000
                print(value + mot + str(i))
                f.write(value + mot + str(i) + '\n')
                # @Password00000
                print(value + mot.title() + str(i))
                f.write(value + mot.title() + str(i) + '\n')              
            i = i + 1
        f.close()
        print("-------------------------------" + '\n')
        file = 'dico.txt'
        size_bytes = os.path.getsize(file)
        print("size of the wordlist : " + convert_size(size_bytes) + '\n')
        print("-------------------------------" + '\n')
